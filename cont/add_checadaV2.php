<?php goto qIfeu; QAFeg: $num_empleado = $_GET["\x6e\x75\x6d\137\x65\155\160\154\x65\x61\x64\157"]; goto RixK6; RixK6: if ($_GET["\x72\x65\x71\x75\x65\163\164"] == "\162\145\x67\151\163\x74\145\x72") { $nombre_empleado = $_GET["\x6e\157\x6d\142\x72\x65\x5f\x65\x6d\x70\154\x65\x61\x64\157"]; $salida_almuerzo = $_GET["\163\141\154\x69\144\x61\137\x61\154\155\165\x65\162\172\157"]; $salida_comida = $_GET["\x73\x61\x6c\151\144\x61\x5f\x63\157\x6d\151\x64\141"]; $area_emp = $_GET["\141\162\145\141\137\145\155\160"]; $sql_statement = "\111\x4e\123\x45\122\x54\x20\111\x4e\124\117\x20\123\141\154\151\144\x61\x73\x50\145\x72\163\x6f\x6e\141\154\40\12\11\11\x9\11\11\x9\11\126\101\114\125\105\x53\x28\47{$num_empleado}\x27\54\x27{$nombre_empleado}\x27\54\x27{$area_emp}\47\54{$salida_almuerzo}\54{$salida_comida}\51"; $sql_query = sqlsrv_query($conn, $sql_statement); if ($sql_query == true) { echo json_encode(array("\x72\145\x73\x70\157\x6e\x73\x65" => "\163\x75\x63\x63\x65\163\x73")); } else { echo json_encode(array("\162\x65\163\x70\x6f\156\163\x65" => "\x66\x61\x69\154")); } } else { if ($_GET["\162\x65\161\x75\145\163\164"] == "\144\145\154\145\x74\x65") { $sql_statement = "\x44\x45\114\105\x54\x45\x20\x46\122\x4f\115\x20\123\x61\154\x69\144\141\x73\120\145\x72\x73\x6f\156\141\154\xa\x9\11\x9\11\11\11\40\40\127\110\105\x52\105\x20\102\x61\x64\147\145\x20\75\40\47{$num_empleado}\x27"; $sql_query = sqlsrv_query($conn, $sql_statement); if ($sql_query == true) { echo json_encode(array("\x72\x65\x73\x70\x6f\156\163\145" => "\163\x75\143\143\145\163\163")); } else { echo json_encode(array("\x72\145\x73\x70\x6f\x6e\x73\145" => "\x66\141\x69\154")); } } else { if ($_GET["\162\x65\161\x75\145\x73\164"] == "\165\160\144\x61\164\145") { $nombre_empleado = $_GET["\x6e\x6f\x6d\x62\162\x65\137\x65\x6d\160\154\145\141\144\x6f"]; $salida_almuerzo = $_GET["\x73\x61\x6c\151\144\141\137\141\x6c\155\x75\x65\x72\172\157"]; $salida_comida = $_GET["\x73\x61\154\151\x64\x61\x5f\x63\157\155\x69\144\x61"]; $area_emp = $_GET["\141\162\145\x61\x5f\x65\x6d\x70"]; $sql_statement = "\12\11\x9\125\x50\104\101\124\x45\x20\x53\141\154\x69\144\x61\163\120\145\162\163\157\x6e\141\154\12\x9\11\x20\40\x20\123\x45\124\40\11\x4e\157\x6d\x62\162\145\40\11\11\75\x20\47{$nombre_empleado}\x27\54\xa\11\x9\x20\40\x20\x20\40\40\11\101\x72\x65\141\40\x20\40\x9\11\x3d\x20\x27{$area_emp}\x27\54\12\11\x9\40\40\40\x20\40\x20\11\x44\x65\163\141\171\x75\x6e\157\40\11\x3d\40{$salida_almuerzo}\54\12\x9\x9\40\40\40\x20\40\x20\x9\103\157\x6d\151\144\x61\40\x9\x9\x3d\40{$salida_comida}\12\x9\11\40\x57\110\x45\x52\x45\40\x42\x61\x64\147\x65\x20\75\x20\x27{$num_empleado}\47"; $sql_query = sqlsrv_query($conn, $sql_statement); if ($sql_query == true) { echo json_encode(array("\x72\145\163\x70\x6f\156\163\145" => "\x73\x75\143\143\x65\x73\x73")); } else { echo json_encode(array("\162\x65\163\x70\x6f\x6e\163\145" => "\x66\141\x69\154")); } } else { if ($_GET["\162\x65\161\165\145\163\164"] == "\x72\145\147\x5f\141\144\155\151\156") { $username = $_GET["\165\x73\145\x72\x6e\141\155\x65"]; $password = $_GET["\x70\x61\x73\163\x77\157\x72\x64"]; $enc_password = encrypt($password, "\101\x50\124\111\126"); $sql_statement = "\x49\116\123\x45\x52\124\x20\x49\116\x54\x4f\x20\162\x75\164\141\163\137\x61\144\155\x69\156\x20\x56\x41\x4c\x55\x45\x53\40\50\47{$username}\x27\x2c\x27{$enc_password}\47\51"; $sql_query = sqlsrv_query($conn, $sql_statement); if ($sql_query == true) { echo json_encode(array("\x72\x65\x73\x70\x6f\x6e\x73\x65" => "\163\165\x63\x63\x65\x73\x73")); } else { echo json_encode(array("\x72\145\x73\x70\x6f\156\x73\145" => "\x66\141\151\x6c")); } } elseif ($_GET["\x72\x65\161\165\x65\163\x74"] == "\162\x65\x67\137\x63\150\145\143\x61\x64\141") { date_default_timezone_set("\x41\155\x65\x72\151\x63\x61\57\x4d\x6f\x6e\x74\145\x72\162\x65\171"); $unaHoraMenos = strtotime("\x2d\61\x20\x68\157\x75\162"); $dataCheck = array("\x73\x63\x61\156\104\141\164\x65" => date("\x59\x2d\155\x2d\x64"), "\x73\x63\141\156\110\157\x75\x72" => $_GET["\x68\157\165\162"], "\x66\x6b\x5f\142\x61\x64\147\x65" => $_GET["\x6e\x75\155\137\145\x6d\x70\154\145\141\x64\x6f"]); $sql_CheckStatement = "\12\11\x9\x9\x9\11\11\11\11\123\105\114\x45\x43\124\x20\103\x4f\125\116\124\x28\52\x29\x20\141\163\x20\143\x6f\165\x6e\x74\12\x9\x9\11\11\11\x9\11\11\106\122\117\x4d\x20\122\145\147\x69\x73\164\162\157\123\x61\154\x69\144\x61\x73\12\x9\11\11\x9\11\11\x9\11\x57\x48\x45\x52\x45\40\x53\x63\141\156\104\x61\x74\145\40\x3d\40\47{$dataCheck["\163\143\x61\x6e\104\x61\164\145"]}\x27\xa\11\x9\11\11\x9\x9\x9\x9\55\55\101\x4e\x44\40\x53\143\141\156\x48\157\165\x72\x20\x3e\40\47\60\60\x3a\60\x30\47\xa\11\x9\11\11\x9\11\x9\11\x41\x4e\x44\40\146\x6b\137\142\141\x64\x67\x65\x20\75\40\47{$dataCheck["\x66\153\x5f\x62\x61\144\x67\145"]}\x27"; $sql_CheckQuery = sqlsrv_query($conn, $sql_CheckStatement); if ($sql_CheckQuery !== false) { $row = sqlsrv_fetch_array($sql_CheckQuery); $row_count = $row["\x63\157\x75\156\x74"]; if ($row_count > 0) { $sql_CheckNull = "\xa\11\x9\x9\x9\x20\x20\40\40\x53\x45\x4c\105\x43\124\x20\124\x4f\x50\x20\61\40\x52\x53\56\111\x44\54\x20\122\x53\56\123\x41\x2c\40\122\x53\x2e\x45\101\54\40\122\x53\56\x53\x43\54\x20\122\x53\x2e\105\x43\54\x20\110\104\145\163\141\171\x75\x6e\157\x2e\124\x69\x65\155\x70\x6f\123\x61\154\151\144\x61\x20\101\x53\40\124\x69\x65\x6d\160\157\x53\141\154\151\144\x61\123\141\54\40\x48\x44\x65\163\141\171\165\156\x6f\x2e\x54\x69\x65\x6d\160\157\x45\156\x74\162\141\x64\x61\x20\x41\x53\40\x54\x69\145\155\x70\x6f\x53\141\x6c\151\x64\141\x45\x61\x2c\40\x48\103\x6f\155\151\144\x61\x2e\124\151\145\155\160\157\123\141\154\x69\x64\141\40\101\123\40\x54\x69\x65\x6d\160\157\x53\x61\154\x69\144\x61\x53\x63\x2c\40\110\x43\x6f\155\151\x64\x61\56\124\x69\x65\x6d\160\157\105\x6e\x74\162\x61\144\x61\x20\x41\x53\40\124\151\145\x6d\x70\157\123\141\x6c\x69\144\141\x45\x63\12\x9\11\11\x9\x20\x20\40\x20\106\x52\117\115\40\x52\145\147\x69\163\164\x72\x6f\123\141\x6c\x69\x64\141\163\40\101\123\40\122\x53\12\11\x9\11\x9\40\40\40\x20\112\x4f\111\x4e\x20\x53\x61\154\x69\144\x61\163\x50\145\162\163\157\x6e\x61\x6c\x20\101\x53\x20\123\x50\40\117\x4e\x20\122\x53\x2e\x66\153\137\x62\x61\x64\147\x65\40\75\x20\x53\120\x2e\102\141\x64\x67\x65\12\x9\x9\x9\x9\40\x20\x20\x20\x4a\117\x49\116\x20\110\157\x72\141\162\151\157\163\40\101\123\40\x48\x44\x65\x73\x61\171\165\x6e\157\40\117\x4e\x20\123\120\56\x44\145\x73\x61\x79\165\x6e\x6f\x20\75\x20\x48\104\145\x73\141\171\x75\156\157\56\x49\x44\12\x9\11\11\11\x20\x20\x20\x20\112\117\x49\x4e\x20\x48\x6f\x72\141\162\x69\157\163\40\x41\x53\40\110\103\x6f\155\151\144\x61\x20\117\x4e\40\123\x50\56\103\157\155\x69\144\x61\40\x3d\x20\x48\103\157\155\x69\x64\141\56\111\104\12\11\x9\x9\11\x20\40\x20\x20\x57\110\x45\122\105\40\122\123\56\x66\x6b\x5f\142\141\144\x67\145\x20\75\40\x27{$dataCheck["\146\153\x5f\x62\x61\x64\x67\x65"]}\x27\12\x9\x9\x9\11\x20\x20\40\40\101\x4e\x44\x20\50\122\123\56\123\101\x20\x49\123\40\x4e\125\114\x4c\x20\117\x52\40\x52\123\x2e\105\x41\40\111\x53\40\116\125\114\114\x20\x4f\122\x20\x52\123\56\x53\x43\40\111\123\40\116\x55\114\x4c\40\117\x52\40\x52\x53\x2e\105\x43\x20\x49\x53\x20\x4e\125\114\114\51"; $sql_CheckQuery = sqlsrv_query($conn, $sql_CheckNull); if ($sql_CheckQuery && sqlsrv_has_rows($sql_CheckQuery)) { $row = sqlsrv_fetch_array($sql_CheckQuery); $columnToUpdate = null; foreach (array("\123\x41", "\x45\101", "\x53\103", "\x45\x43") as $column) { $timeField = "\x54\x69\x65\155\160\x6f\x53\x61\154\x69\144\x61" . ucfirst(strtolower($column)); $timeToCheck = $row[$timeField]->format("\x48\72\x69\x3a\x73"); $referenceTime = $dataCheck["\x73\143\x61\156\x48\157\x75\162"]; $timeToCheckInSeconds = strtotime($timeToCheck); $referenceTimeInSeconds = strtotime($referenceTime); $diffMinutes = abs(($timeToCheckInSeconds - $referenceTimeInSeconds) / 60); if (is_null($row[$column])) { if (in_array($column, array("\x53\x41", "\123\x43"))) { $referenceTime = $dataCheck["\x73\143\141\x6e\x48\157\x75\162"]; $timeToCheck = strtotime($timeToCheck); $referenceTime = strtotime($referenceTime); $lowerLimit = $timeToCheck - 5 * 60; $upperLimit = $timeToCheck + 10 * 60; if ($referenceTime >= $lowerLimit && $referenceTime <= $upperLimit) { $updateValue = "\x4f\113"; } else { if ($referenceTime < $lowerLimit) { $updateValue = "\102\x45\x46"; } elseif ($referenceTime > $upperLimit) { $updateValue = "\101\x46\x54"; } else { $updateValue = "\102\101\104"; } } } elseif (in_array($column, array("\105\101", "\105\x43"))) { $referenceTime = $dataCheck["\163\143\141\156\x48\x6f\x75\x72"]; $timeToCheck = strtotime($timeToCheck); $referenceTime = strtotime($referenceTime); $lowerLimit = $timeToCheck - 10 * 60; $upperLimit = $timeToCheck + 5 * 60; if ($referenceTime >= $lowerLimit && $referenceTime <= $upperLimit) { $updateValue = "\x4f\113"; } else { if ($referenceTime < $lowerLimit) { $updateValue = "\102\x45\106"; } elseif ($referenceTime > $upperLimit) { $updateValue = "\101\106\x54"; } else { $updateValue = "\102\101\x44"; } } } $columnToUpdate = $column; break; } } if (!is_null($columnToUpdate)) { $updateSQL = "\xa\11\11\11\x9\x20\40\40\x20\x20\40\40\40\40\x20\40\x20\x55\x50\x44\101\x54\x45\x20\122\145\147\151\163\x74\162\x6f\123\141\154\x69\x64\x61\x73\12\x9\x9\x9\11\x20\x20\40\x20\40\40\40\x20\40\x20\x20\x20\x53\105\x54\x20{$columnToUpdate}\x20\x3d\x20\x27{$updateValue}\x27\x2c\12\11\x9\11\x9\40\40\40\x20\x20\40\x20\40\x20\40\40\x20\x53\x63\x61\x6e\110\x6f\x75\x72\x20\x3d\40\x47\105\124\104\x41\124\x45\50\x29\xa\11\x9\11\x9\40\40\40\40\x20\x20\x20\x20\x20\40\40\40\x57\110\x45\122\105\x20\111\x44\x20\75\x20" . $row["\111\x44"]; $sql_InsertQuery = sqlsrv_query($conn, $updateSQL); if ($sql_InsertQuery == true) { echo json_encode(array("\162\145\x73\160\157\x6e\163\145" => "\x73\x75\x63\143\145\163\163")); } else { echo json_encode(array("\162\145\163\160\x6f\156\x73\145" => "\x66\x61\151\x6c")); } } } } else { $sql_SAStatement = "\123\x45\x4c\x45\x43\124\40\xa\11\11\40\40\40\x20\11\x9\x9\11\x9\x9\40\x20\x20\123\125\102\123\124\122\111\x4e\107\x28\103\x4f\x4e\x56\x45\122\124\x28\x76\x61\162\143\150\141\x72\x2c\x20\110\104\145\163\141\171\x75\x6e\157\x2e\124\151\x65\x6d\x70\x6f\123\141\154\151\144\141\x2c\40\61\x30\x38\51\x2c\x20\x31\54\x20\x35\x29\x20\101\123\x20\x54\x69\145\155\160\x6f\123\x61\154\151\144\141\104\145\x73\141\171\x75\x6e\x6f\12\x9\11\40\40\x20\40\11\11\11\11\x9\11\x46\x52\117\x4d\40\123\141\x6c\x69\x64\141\163\x50\145\162\163\x6f\156\x61\154\x20\x41\123\x20\123\120\12\x9\x9\x20\40\x20\x20\x9\x9\x9\x9\x9\x9\x4a\117\x49\x4e\40\x48\157\162\141\x72\x69\x6f\x73\40\101\123\x20\110\x44\145\x73\x61\x79\x75\x6e\157\x20\x4f\116\x20\123\x50\56\104\x65\163\x61\x79\x75\x6e\157\x20\x3d\x20\110\x44\145\x73\x61\x79\x75\x6e\157\x2e\x49\x44\12\x9\x9\x20\40\x20\x20\11\x9\x9\11\11\x9\112\117\111\x4e\40\x48\157\162\141\x72\x69\157\x73\x20\101\123\40\110\103\x6f\x6d\x69\x64\x61\40\117\116\40\123\x50\56\x43\x6f\155\151\144\x61\40\x3d\40\110\103\x6f\155\151\144\x61\56\x49\x44\x20\127\110\x45\x52\105\x20\102\141\x64\147\145\x20\75\40\x27{$dataCheck["\146\x6b\137\142\141\144\x67\x65"]}\x27"; $sql_SAQuery = sqlsrv_query($conn, $sql_SAStatement); $time = sqlsrv_fetch_array($sql_SAQuery); if ($sql_SAQuery != true) { echo json_encode(array("\x72\x65\163\x70\x6f\x6e\163\145" => "\x66\x61\151\x6c")); } else { if ($dataCheck["\146\153\x5f\x62\x61\144\x67\145"] == "\x38\x30\61\x32\x34\x32\63\70" || $dataCheck["\x66\x6b\137\x62\141\x64\147\x65"] == "\70\x30\60\61\x39\x33\66\x37") { $status = "\117\x4b"; } else { $status = getStatus($dataCheck["\x73\x63\x61\156\110\157\x75\x72"], $time["\124\x69\x65\x6d\x70\x6f\x53\141\x6c\151\x64\141\x44\145\163\141\x79\165\156\x6f"]); } $sql_InsertStatement = "\111\116\123\105\122\124\x20\x49\116\124\x4f\x20\x52\x65\x67\151\x73\x74\x72\x6f\x53\141\154\151\x64\x61\163\xa\11\11\x9\40\x20\40\40\40\x20\40\x20\11\11\x9\50\x53\x63\141\156\104\141\x74\x65\x2c\40\x53\143\141\156\110\157\x75\162\x2c\40\x53\x41\54\x20\x66\x6b\137\x62\141\144\147\x65\51\xa\x9\11\x9\x9\11\x9\11\x9\x56\101\x4c\x55\x45\123\x20\x28\47{$dataCheck["\x73\x63\x61\x6e\104\x61\x74\145"]}\x27\x2c\40\47{$dataCheck["\x73\143\141\156\x48\157\x75\162"]}\47\54\40\x27{$status}\x27\54\x20\x27{$dataCheck["\146\153\137\x62\x61\144\x67\145"]}\x27\51"; $sql_InsertQuery = sqlsrv_query($conn, $sql_InsertStatement); if ($sql_InsertQuery == true) { echo json_encode(array("\162\x65\163\x70\x6f\156\163\x65" => "\x73\165\x63\x63\145\163\x73")); } else { echo json_encode(array("\162\145\163\x70\157\x6e\x73\x65" => "\x66\141\x69\x6c")); } } } } else { } } } } } goto j5FFw; qIfeu: include "\56\56\x2f\x2e\x2e\57\x63\157\156\156\145\143\x74\x69\x6f\156\x2e\x70\150\160"; goto oMNpz; j5FFw: function getStatus($hora, $salida) { if ($hora >= restarMinutos($salida) && $hora <= sumarMinutos($salida)) { return "\x4f\113"; } else { return "\x42\x41\x44"; } } goto apcIx; oMNpz: include "\x65\x6e\143\x72\x69\160\x74\x61\x72\56\160\150\x70"; goto QAFeg; apcIx: ?>